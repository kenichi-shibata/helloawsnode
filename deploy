#!/bin/bash

install-dev() {
  sudo apt install -y unzip 
  wget "https://releases.hashicorp.com/packer/1.0.4/packer_1.0.4_linux_amd64.zip"
  unzip packer_1.0.4_linux_amd64.zip
  rm packer_1.0.4_linux_amd64.zip
}

case $1 in 

  ami) 
    AWS_PROFILE=test.builder ./packer build -var-file=infra/vm/variables.json infra/vm/packer.json
     ;;

  network)
   echo 'network'
   cd infra/setup-cloud-network
   terraform init
   terraform plan
   terraform apply
   terraform output -json > network-out.json
   mv network-out.json ../..
   cd ../.. 
     ;;
   *)
            echo $"Usage: $0 {ami|network|application}"
            exit 1
esac
